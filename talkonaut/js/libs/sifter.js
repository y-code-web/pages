!function(t,r){"function"==typeof define&&define.amd?define(r):"object"==typeof exports?module.exports=r():t.Sifter=r()}(this,function(){var t=function(t,r){this.items=t,this.settings=r||{diacritics:!0}};t.prototype.tokenize=function(t){if(!(t=f(String(t||"").toLowerCase()))||!t.length)return[];var r,e,n,i,o=[],s=t.split(/ +/);for(r=0,e=s.length;r<e;r++){if(n=u(s[r]),this.settings.diacritics)for(i in c)c.hasOwnProperty(i)&&(n=n.replace(new RegExp(i,"g"),c[i]));o.push({string:s[r],regex:new RegExp(n,"i")})}return o},t.prototype.iterator=function(t,r){(s(t)?Array.prototype.forEach||function(t){for(var r=0,e=this.length;r<e;r++)t(this[r],r,this)}:function(t){for(var r in this)this.hasOwnProperty(r)&&t(this[r],r,this)}).apply(t,[r])},t.prototype.getScoreFunction=function(t,r){var i,o,s,f;t=this.prepareSearch(t,r),o=t.tokens,i=t.options.fields,s=o.length,f=t.options.nesting;var u,c=function(t,r){var e,n;return t?-1===(n=(t=String(t||"")).search(r.regex))?0:(e=r.string.length/t.length,0===n&&(e+=.5),e):0},p=(u=i.length)?1===u?function(t,r){return c(g(r,i[0],f),t)}:function(t,r){for(var e=0,n=0;e<u;e++)n+=c(g(r,i[e],f),t);return n/u}:function(){return 0};return s?1===s?function(t){return p(o[0],t)}:"and"===t.options.conjunction?function(t){for(var r,e=0,n=0;e<s;e++){if((r=p(o[e],t))<=0)return 0;n+=r}return n/s}:function(t){for(var r=0,e=0;r<s;r++)e+=p(o[r],t);return e/s}:function(){return 0}},t.prototype.getSortFunction=function(t,e){var r,n,i,o,s,f,u,c,p,a,h;if(h=!(t=(i=this).prepareSearch(t,e)).query&&e.sort_empty||e.sort,p=function(t,r){return"$score"===t?r.score:g(i.items[r.id],t,e.nesting)},s=[],h)for(r=0,n=h.length;r<n;r++)(t.query||"$score"!==h[r].field)&&s.push(h[r]);if(t.query){for(a=!0,r=0,n=s.length;r<n;r++)if("$score"===s[r].field){a=!1;break}a&&s.unshift({field:"$score",direction:"desc"})}else for(r=0,n=s.length;r<n;r++)if("$score"===s[r].field){s.splice(r,1);break}for(c=[],r=0,n=s.length;r<n;r++)c.push("desc"===s[r].direction?-1:1);return(f=s.length)?1===f?(o=s[0].field,u=c[0],function(t,r){return u*l(p(o,t),p(o,r))}):function(t,r){var e,n,i;for(e=0;e<f;e++)if(i=s[e].field,n=c[e]*l(p(i,t),p(i,r)))return n;return 0}:null},t.prototype.prepareSearch=function(t,r){if("object"==typeof t)return t;var e=(r=o({},r)).fields,n=r.sort,i=r.sort_empty;return e&&!s(e)&&(r.fields=[e]),n&&!s(n)&&(r.sort=[n]),i&&!s(i)&&(r.sort_empty=[i]),{options:r,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var n,i,r,o,s=this;return i=this.prepareSearch(t,e),e=i.options,t=i.query,o=e.score||s.getScoreFunction(i),t.length?s.iterator(s.items,function(t,r){n=o(t),(!1===e.filter||0<n)&&i.items.push({score:n,id:r})}):s.iterator(s.items,function(t,r){i.items.push({score:1,id:r})}),(r=s.getSortFunction(i,e))&&i.items.sort(r),i.total=i.items.length,"number"==typeof e.limit&&(i.items=i.items.slice(0,e.limit)),i};var l=function(t,r){return"number"==typeof t&&"number"==typeof r?r<t?1:t<r?-1:0:(t=e(String(t||"")),(r=e(String(r||"")))<t?1:t<r?-1:0)},o=function(t,r){var e,n,i,o;for(e=1,n=arguments.length;e<n;e++)if(o=arguments[e])for(i in o)o.hasOwnProperty(i)&&(t[i]=o[i]);return t},g=function(t,r,e){if(t&&r){if(!e)return t[r];for(var n=r.split(".");n.length&&(t=t[n.shift()]););return t}},f=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},u=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},s=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},c={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},e=function(){var t,r,e,n,i="",o={};for(e in c)if(c.hasOwnProperty(e))for(i+=n=c[e].substring(2,c[e].length-1),t=0,r=n.length;t<r;t++)o[n.charAt(t)]=e;var s=new RegExp("["+i+"]","g");return function(t){return t.replace(s,function(t){return o[t]}).toLowerCase()}}();return t});
//# sourceMappingURL=sifter.js.map
